"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,t,o){return e(o={path:t,exports:{},require:(e,t)=>function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&o.path)},o.exports),o.exports}Object.defineProperty(exports,"__esModule",{value:!0});const o=t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isObject=void 0,t.isObject=function(e){return null!==e&&"object"==typeof e}})),n=t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getAllOperations=void 0;const r=["get","head","post","put","patch","delete","options","trace"];t.getAllOperations=function*(e){if(!o.isObject(e))return;const t={path:"",operation:""};for(const n of Object.keys(e)){const s=e[n];if(o.isObject(s)){t.path=n;for(const e of Object.keys(s))o.isObject(s[e])&&r.includes(e)&&(t.operation=e,yield t)}}}})),checkSecurity=e(t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.oasOpSecurityDefined=void 0,t.oasOpSecurityDefined=(e,t)=>{const r=[],{schemesPath:s,nullable:i,methods:c}=t,{paths:u}=e;for(const{path:t,operation:a}of n.getAllOperations(u)){if(c&&Array.isArray(c)&&!c.includes(a))continue;let{security:n}=u[t][a],p=[t,a];if(void 0===n&&(n=e.security,p=["$.security"]),n&&0!==n.length||r.push({message:`Operation has undefined security scheme in ${p}.`,path:["paths",t,a,"security",s]}),Array.isArray(n))for(const[e,s]of n.entries())o.isObject(s)&&0===Object.keys(s).length&&!1===i&&r.push({message:`Operation referencing empty security scheme in ${p}.`,path:["paths",t,a,"security",e]})}return r},t.default=t.oasOpSecurityDefined})));exports.default=checkSecurity;