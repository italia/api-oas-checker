rules:
  sec-number-boundaries:
    description: |-
      Numeric values should be limited in size to mitigate resource exhaustion
      using either `maximum` and `minimum` or `enum`.

      If you delegate input validation to a library or framework,
      be sure to test it thoroughly.
    message: >-
      Schema of type number or integer must specify a maximum and a minimum or enum. {{path}} {{error}}
    formats:
    - oas3
    severity: warn
    recommended: true
    given:
    - >-
      $..[?(@.type=="number")]
    - >-
      $..[?(@.type=="integer")]
    then:
      function: schema
      functionOptions:
        schema:
          anyOf:
          - type: object
            required: [maximum, minimum]
            not:
              required: [enum]
          - type: object
            required: [enum]
            not:
              required: [maximum, minimum]
